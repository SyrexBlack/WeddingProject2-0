# Architecture Research

**Домен:** Свадебный одностраничный сайт-приглашение
**Дата исследования:** 2026-02-22
**Уверенность:** ВЫСОКАЯ

## Обзор системы

Одностраничное приложение (SPA-подобная структура) на базе Next.js 15 App Router, генерируемое статически (SSG). Все секции компонуются на единственной странице `page.tsx`. Внешние сервисы подключаются только для карты и отправки RSVP.

```
┌─────────────────────────────────────────────────────┐
│                   Vercel (хостинг)                   │
│  ┌───────────────────────────────────────────────┐  │
│  │              Next.js 15 App Router             │  │
│  │                  (SSG / Static)                │  │
│  │                                                │  │
│  │  ┌─────────────────────────────────────────┐  │  │
│  │  │           page.tsx (Главная)             │  │  │
│  │  │                                         │  │  │
│  │  │  ┌─────────┐  ┌────────────┐           │  │  │
│  │  │  │  Hero   │  │ Countdown  │           │  │  │
│  │  │  └─────────┘  └────────────┘           │  │  │
│  │  │  ┌─────────┐  ┌────────────┐           │  │  │
│  │  │  │  Info   │  │  Timeline  │           │  │  │
│  │  │  └─────────┘  └────────────┘           │  │  │
│  │  │  ┌─────────┐  ┌────────────┐           │  │  │
│  │  │  │ Gallery │  │    Map     │──────────────────── Yandex/Google Maps API
│  │  │  └─────────┘  └────────────┘           │  │  │
│  │  │  ┌─────────┐  ┌────────────┐           │  │  │
│  │  │  │  RSVP   │──│  Footer    │           │  │  │
│  │  │  └────┬────┘  └────────────┘           │  │  │
│  │  │       │                                 │  │  │
│  │  └───────┼─────────────────────────────────┘  │  │
│  │          │                                     │  │
│  └──────────┼─────────────────────────────────────┘  │
│             │                                         │
└─────────────┼─────────────────────────────────────────┘
              │
              ▼
   ┌─────────────────────┐
   │  Внешний сервис      │
   │  EmailJS / Formspree │
   │  / Google Sheets     │
   └─────────────────────┘
```

### Потоки данных

```
┌──────────────────┐       Импорт при сборке        ┌──────────────────┐
│  lib/constants.ts │ ─────────────────────────────▶ │  Все секции       │
│  (имена, дата,    │       (статические данные)     │  (Hero, Info,     │
│   место, меню)    │                                │   Countdown и тд) │
└──────────────────┘                                └──────────────────┘

┌──────────────────┐       POST-запрос (клиент)     ┌──────────────────┐
│  RSVP-форма       │ ─────────────────────────────▶ │  EmailJS /        │
│  (имя, участие,   │       fetch() / SDK           │  Formspree /      │
│   доп. данные)    │                                │  Google Sheets    │
└──────────────────┘                                └──────────────────┘

┌──────────────────┐       iframe / JS SDK          ┌──────────────────┐
│  Map-компонент    │ ─────────────────────────────▶ │  Yandex Maps API  │
│                   │       (загрузка на клиенте)    │  / Google Maps    │
└──────────────────┘                                └──────────────────┘
```

## Ответственности компонентов

| Компонент | Ответственность | Типичная реализация |
|-----------|----------------|---------------------|
| `layout.tsx` | Корневой лейаут: подключение шрифтов, метаданные, OG-теги, глобальные стили | Server Component, `<html>`, `<body>`, Google Fonts через `next/font` |
| `page.tsx` | Композиция всех секций в правильном порядке | Server Component, импортирует и рендерит все секции последовательно |
| `Hero` | Полноэкранный блок с именами пары, датой, фоновым изображением | Server Component + Framer Motion для анимации появления |
| `Countdown` | Обратный отсчёт до даты свадьбы (дни, часы, минуты, секунды) | **Client Component** (`'use client'`), использует `useCountdown` хук с `setInterval` |
| `Info` | Информационные карточки: «Где», «Когда», «Дресс-код» | Server Component, данные из `constants.ts`, иконки Lucide |
| `Timeline` | Программа дня (таймлайн событий: регистрация, банкет и т.д.) | Server Component, массив событий из `constants.ts` |
| `Gallery` | Фотогалерея пары (сетка/карусель) | **Client Component** для свайпа/модалки, `next/image` для оптимизации |
| `Map` | Интерактивная карта с меткой места проведения | **Client Component**, загрузка Yandex/Google Maps SDK динамически |
| `RSVP` | Форма подтверждения участия: имя, «приду/не приду», комментарий | **Client Component**, обработка формы, отправка через EmailJS/Formspree |
| `Footer` | Подвал с контактами, ссылками на соцсети, копирайтом | Server Component |
| `AnimatedSection` | Обёртка для анимации появления секции при скролле | **Client Component**, Framer Motion `motion.div` + `whileInView` |
| `Button` | Переиспользуемая кнопка (CTA, отправка формы) | Tailwind-стилизация, варианты через пропсы |
| `Card` | Переиспользуемая карточка для информационных блоков | Tailwind-стилизация, слоты для иконки/заголовка/текста |
| `useCountdown` | Кастомный хук для расчёта оставшегося времени | `useState` + `useEffect` + `setInterval`, возвращает `{days, hours, minutes, seconds}` |

## Рекомендуемая структура проекта

```
src/
├── app/                        # Next.js 15 App Router
│   ├── layout.tsx              # Корневой лейаут: шрифты, метаданные, OG-теги
│   ├── page.tsx                # Главная страница — композиция всех секций
│   ├── globals.css             # Глобальные стили + Tailwind директивы
│   └── favicon.ico             # Иконка сайта
│
├── components/                 # React-компоненты
│   ├── sections/               # Секции страницы (по порядку отображения)
│   │   ├── Hero.tsx            # Полноэкранный баннер с именами и датой
│   │   ├── Countdown.tsx       # Обратный отсчёт до свадьбы
│   │   ├── Info.tsx            # Карточки «Где / Когда / Дресс-код»
│   │   ├── Timeline.tsx        # Программа дня (таймлайн)
│   │   ├── Gallery.tsx         # Фотогалерея
│   │   ├── Map.tsx             # Интерактивная карта
│   │   ├── RSVP.tsx            # Форма подтверждения участия
│   │   └── Footer.tsx          # Подвал страницы
│   │
│   └── ui/                     # Переиспользуемые UI-компоненты
│       ├── Button.tsx          # Кнопка с вариантами стилей
│       ├── Card.tsx            # Универсальная карточка
│       ├── AnimatedSection.tsx # Обёртка с анимацией появления при скролле
│       └── Container.tsx       # Обёртка для ограничения ширины контента
│
├── lib/                        # Утилиты и конфигурация
│   ├── constants.ts            # ВСЕ данные свадьбы: имена, дата, место, меню, контакты
│   └── utils.ts                # Вспомогательные функции (cn для Tailwind, форматирование)
│
├── hooks/                      # Кастомные React-хуки
│   └── useCountdown.ts         # Хук обратного отсчёта
│
├── types/                      # TypeScript-типы
│   └── index.ts                # WeddingData, RSVPFormData, TimelineEvent и т.д.
│
└── assets/                     # Статические ресурсы
    └── images/                 # Фотографии (оптимизируются через next/image)
```

### Обоснование структуры

- **`sections/`** отделены от **`ui/`** — секции содержат бизнес-логику отображения, UI — переиспользуемые примитивы
- **`lib/constants.ts`** — единый источник истины для всех данных свадьбы; менять контент можно в одном файле
- **`hooks/`** — выделение логики обратного отсчёта в хук позволяет тестировать и переиспользовать
- **`types/`** — TypeScript-типы в отдельной папке обеспечивают типобезопасность всего приложения

## Архитектурные паттерны

### 1. Секционная композиция (Section-based Composition)

Страница строится как вертикальная последовательность независимых секций. Каждая секция — самодостаточный компонент, который получает данные через импорт из `constants.ts` или через пропсы. Секции не общаются друг с другом напрямую — нет общего состояния между ними.

```tsx
// app/page.tsx
export default function Home() {
  return (
    <main>
      <Hero />
      <Countdown />
      <Info />
      <Timeline />
      <Gallery />
      <Map />
      <RSVP />
      <Footer />
    </main>
  );
}
```

### 2. Данные через константы (Data-driven Content)

Все свадебные данные вынесены в `lib/constants.ts`. Это позволяет:
- Менять контент без правки компонентов
- Типизировать данные через TypeScript
- Потенциально переиспользовать шаблон для другой свадьбы

```tsx
// lib/constants.ts
export const WEDDING = {
  bride: "Анна",
  groom: "Михаил",
  date: new Date("2026-08-15T15:00:00"),
  venue: { name: "Ресторан «Времена года»", address: "...", coords: [55.75, 37.62] },
  timeline: [ ... ],
  dressCode: "Smart Casual",
} as const;
```

### 3. Разделение Server/Client Components

Next.js 15 App Router по умолчанию рендерит компоненты на сервере. Клиентские компоненты (`'use client'`) нужны только там, где есть:
- **Интерактивность** (формы, кнопки с обработчиками)
- **Браузерное API** (`setInterval` для таймера, загрузка карт SDK)
- **Состояние** (`useState`, `useEffect`)

| Тип | Компоненты |
|-----|-----------|
| Server Component | `layout.tsx`, `page.tsx`, `Hero`, `Info`, `Timeline`, `Footer` |
| Client Component | `Countdown`, `Gallery`, `Map`, `RSVP`, `AnimatedSection` |

**Принцип:** Держать клиентскую границу (`'use client'`) как можно ниже в дереве компонентов. Например, `Hero` может быть серверным, а внутри него `AnimatedSection` — клиентским.

### 4. Бессерверная отправка формы (Serverless Form Submission)

RSVP-форма отправляет данные напрямую во внешний сервис через клиентский `fetch()`:
- **EmailJS** — отправка email без бэкенда (бесплатно до 200 писем/мес)
- **Formspree** — HTML-формы с бэкендом (бесплатно до 50 отправок/мес)
- **Google Sheets API** — запись в таблицу через Google Apps Script (бесплатно, без ограничений)

Рекомендация: **Google Sheets** как основной вариант (бесплатно, удобно просматривать ответы), **EmailJS** как уведомление для пары.

### 5. Статическая генерация (SSG)

Весь сайт генерируется статически при сборке (`next build`). Это обеспечивает:
- Мгновенную загрузку (HTML готов, не ждёт сервер)
- Нулевую стоимость хостинга на Vercel
- Отличные показатели Core Web Vitals

Клиентские компоненты гидрируются после загрузки — таймер начинает тикать, карта загружается, форма становится интерактивной.

## Поток данных

### Статические данные (при сборке)

```
constants.ts ──▶ page.tsx ──▶ Hero (имена, дата)
                          ──▶ Countdown (дата)
                          ──▶ Info (место, дресс-код)
                          ──▶ Timeline (программа)
                          ──▶ Gallery (массив фотографий)
                          ──▶ Map (координаты)
                          ──▶ Footer (контакты)
```

Данные импортируются напрямую — нет API, нет загрузки данных на клиенте, нет стейт-менеджмента. Это самый простой и надёжный паттерн для статического сайта.

### Динамические данные (на клиенте)

```
Пользователь заполняет RSVP-форму
        │
        ▼
  useState (локальное состояние формы)
        │
        ▼
  Валидация на клиенте
        │
        ▼
  fetch() ──▶ EmailJS API / Google Apps Script
        │
        ▼
  Отображение результата (успех/ошибка)
```

```
useCountdown хук
        │
        ▼
  setInterval (каждую секунду)
        │
        ▼
  Вычисление разницы между target и now
        │
        ▼
  setState ({days, hours, minutes, seconds})
        │
        ▼
  Ре-рендер компонента Countdown
```

## Антипаттерны (чего избегать)

| Антипаттерн | Почему плохо | Что делать вместо |
|-------------|-------------|-------------------|
| Redux / Zustand для состояния | Оверинжиниринг для одностраничника без общего состояния | Локальный `useState` в RSVP-форме, хук для таймера |
| SSR вместо SSG | Сайт статический, SSR добавит задержку и стоимость серверного выполнения | `output: 'export'` в `next.config.ts` для полного статического экспорта |
| Неоптимизированные изображения | Свадебные фото по 5-10 МБ убьют загрузку на мобильных | `next/image` с автоматическим resize, WebP, lazy loading |
| Все компоненты как `'use client'` | Увеличивает размер JS-бандла, теряет преимущества Server Components | Клиентская директива только где реально нужна интерактивность |
| Загрузка карты без ленивой загрузки | Maps SDK весит ~200-500 КБ, блокирует первую отрисовку | `dynamic(() => import('./Map'), { ssr: false })` или Intersection Observer |
| Хардкод данных в компонентах | Сложно менять контент, дублирование | Все данные в `constants.ts`, компоненты получают через пропсы/импорт |
| Отсутствие обработки ошибок в RSVP | Пользователь не понимает, отправилась ли форма | Try/catch + визуальная обратная связь (тост, сообщение об успехе) |

## Точки интеграции

### 1. Yandex Maps / Google Maps

- **Способ подключения:** Динамический импорт SDK через `<script>` или `@react-google-maps/api` / `@pbe/react-yandex-maps`
- **Ключ API:** Хранить в переменных окружения (`NEXT_PUBLIC_MAPS_API_KEY`)
- **Ленивая загрузка:** Карта загружается только когда пользователь доскролливает до секции
- **Fallback:** Статическое изображение карты + ссылка «Открыть в Яндекс.Картах»

### 2. EmailJS / Formspree / Google Sheets

- **EmailJS:** `@emailjs/browser` SDK, инициализация с `publicKey`, отправка через `emailjs.send()`
- **Formspree:** Простой `fetch()` POST на `https://formspree.io/f/{id}`
- **Google Sheets:** Google Apps Script как webhook, `fetch()` POST с JSON-данными
- **Ключи:** Хранить в `NEXT_PUBLIC_*` переменных окружения (клиентский доступ)
- **Rate limiting:** Полагаемся на лимиты самих сервисов; можно добавить простой debounce на кнопке

### 3. Vercel (хостинг и деплой)

- **Деплой:** Автоматический при `git push` в main-ветку
- **Домен:** Бесплатный `.vercel.app` или кастомный домен
- **HTTPS:** Из коробки
- **CDN:** Статические ассеты автоматически раздаются через Edge Network

### 4. Google Fonts (шрифты)

- **Подключение:** Через `next/font/google` — оптимальная загрузка, self-hosted
- **Рекомендация:** 1 акцидентный шрифт для заголовков + 1 текстовый шрифт для контента
- **Пример:** `Playfair Display` (заголовки) + `Inter` или `Lora` (текст)

### 5. Open Graph / Social Preview

- **Реализация:** Метаданные в `layout.tsx` через `export const metadata`
- **OG Image:** Статическое изображение 1200×630px в `public/og-image.jpg`
- **Важно для:** Красивое превью ссылки при отправке через Telegram / WhatsApp

## Рекомендуемый порядок сборки

Порядок учитывает зависимости между компонентами. Каждый этап можно деплоить и проверять отдельно.

```
Этап 1: Фундамент
├── Инициализация проекта (Next.js 15, Tailwind CSS 4, ESLint, TypeScript)
├── layout.tsx (шрифты, метаданные, глобальные стили)
├── lib/constants.ts (структура данных свадьбы)
├── types/index.ts (TypeScript-типы)
└── components/ui/Container.tsx (обёртка контента)

Этап 2: Статические секции (не требуют JS на клиенте)
├── Hero.tsx (фоновое изображение, имена, дата)
├── Info.tsx (информационные карточки)
├── Timeline.tsx (программа дня)
└── Footer.tsx (контакты, соцсети)

Этап 3: Клиентские компоненты
├── components/ui/AnimatedSection.tsx (Framer Motion обёртка)
├── hooks/useCountdown.ts (хук таймера)
├── Countdown.tsx (обратный отсчёт)
└── Gallery.tsx (фотогалерея с модалкой/каруселью)

Этап 4: Внешние интеграции
├── Map.tsx (подключение Yandex/Google Maps)
└── RSVP.tsx (форма + интеграция с EmailJS/Google Sheets)

Этап 5: Полировка и деплой
├── Анимации скролла для всех секций
├── OG-теги и social preview
├── Оптимизация изображений
├── Тестирование на мобильных устройствах
└── Деплой на Vercel
```

### Зависимости между этапами

- **Этап 2 зависит от Этапа 1:** секции используют типы, константы и лейаут
- **Этап 3 зависит от Этапа 2:** анимации оборачивают уже существующие секции
- **Этап 4 зависит от Этапа 1:** нужны переменные окружения и базовая структура
- **Этап 5 зависит от всех предыдущих:** полировка и оптимизация финального результата

## Источники и референсы

- [Next.js 15 App Router — официальная документация](https://nextjs.org/docs/app)
- [Tailwind CSS 4 — документация](https://tailwindcss.com/docs)
- [Framer Motion — документация](https://motion.dev/)
- [nextjs-wedding-invite — GitHub](https://github.com/wzulfikar/nextjs-wedding-invite)
- [wedding-invitation — GitHub](https://github.com/LeeKyuHyuk/wedding-invitation)
- [EmailJS — документация](https://www.emailjs.com/docs/)
- [Formspree — документация](https://formspree.io/docs/)
- [Vercel — деплой Next.js](https://vercel.com/docs/frameworks/nextjs)

---
*Архитектурное исследование для: свадебный сайт-приглашение*
*Дата: 2026-02-22*
